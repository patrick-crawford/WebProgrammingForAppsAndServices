"use strict";(self.webpackChunkipc144=self.webpackChunkipc144||[]).push([[1200],{3905:(t,e,n)=>{n.d(e,{Zo:()=>c,kt:()=>h});var a=n(7294);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,a,o=function(t,e){if(null==t)return{};var n,a,o={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var p=a.createContext({}),l=function(t){var e=a.useContext(p),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},c=function(t){var e=l(t.components);return a.createElement(p.Provider,{value:e},t.children)},d="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},m=a.forwardRef((function(t,e){var n=t.components,o=t.mdxType,r=t.originalType,p=t.parentName,c=s(t,["components","mdxType","originalType","parentName"]),d=l(n),m=o,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||r;return n?a.createElement(h,i(i({ref:e},c),{},{components:n})):a.createElement(h,i({ref:e},c))}));function h(t,e){var n=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var r=n.length,i=new Array(r);i[0]=m;var s={};for(var p in e)hasOwnProperty.call(e,p)&&(s[p]=e[p]);s.originalType=t,s[d]="string"==typeof t?t:o,i[1]=s;for(var l=2;l<r;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6493:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var a=n(7462),o=(n(7294),n(3905));n(8209);const r={id:"implementation-shopping-cart",title:"Implementation: Shopping Cart",sidebar_position:3,description:"Implementation: Shopping Cart"},i="Implementation: Shopping Cart",s={unversionedId:"Managing-Application-State/implementation-shopping-cart",id:"Managing-Application-State/implementation-shopping-cart",title:"Implementation: Shopping Cart",description:"Implementation: Shopping Cart",source:"@site/docs/Managing-Application-State/implementation-shopping-cart.md",sourceDirName:"Managing-Application-State",slug:"/Managing-Application-State/implementation-shopping-cart",permalink:"/Managing-Application-State/implementation-shopping-cart",draft:!1,editUrl:"hhttps://github.com/patrick-crawford/WebProgrammingForAppsAndServices/tree/master/docs/Managing-Application-State/implementation-shopping-cart.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"implementation-shopping-cart",title:"Implementation: Shopping Cart",sidebar_position:3,description:"Implementation: Shopping Cart"},sidebar:"courseNotesSidebar",previous:{title:"Introducing Jotai",permalink:"/Managing-Application-State/introducing-jotai"},next:{title:"Example Code",permalink:"/Managing-Application-State/example-code"}},p={},l=[{value:"Getting Started",id:"getting-started",level:2},{value:"File Structure",id:"file-structure",level:3},{value:"Adding &quot;Cart&quot; state with Jotai",id:"adding-cart-state-with-jotai",level:2},{value:"Updating &quot;Layout&quot;",id:"updating-layout",level:3},{value:"Updating &quot;addToCart()&quot; Functions",id:"updating-addtocart-functions",level:3},{value:"Updating the &quot;cart&quot; Page",id:"updating-the-cart-page",level:3}],c={toc:l},d="wrapper";function u(t){let{components:e,...n}=t;return(0,o.kt)(d,(0,a.Z)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"implementation-shopping-cart"},"Implementation: Shopping Cart"),(0,o.kt)("p",null,'As we have seen, Jotai greatly improves and simplifies working with "application level" state, as compared to built in methods such as "Prop Drilling" and "Context".'),(0,o.kt)("p",null,'When the need for "application level" state was first discussed, one possible use case was an e-commerce site that implements a shopping cart. As an extended example for Jotai, let\'s use it to implement a simplified shopping cart for a site that pulls a list of products from ',(0,o.kt)("a",{parentName:"p",href:"https://dummyjson.com"},"DummyJSON"),"."),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,'To begin, we will use the "shopping-state-missing" example from the sample code: ',(0,o.kt)("a",{parentName:"p",href:"/Managing-Application-State/example-code"},"Managing-Application-State")," as a starting point."),(0,o.kt)("p",null,"Once you have the source code downloaded:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},'Open the "shopping-state-missing" folder in your code editor (ie: "Visual Studio Code")'),(0,o.kt)("li",{parentName:"ol"},'Open the "my-app" folder in the integrated terminal'),(0,o.kt)("li",{parentName:"ol"},'Run the command "npm install" (alternatively: "npm i") to install the dependencies'),(0,o.kt)("li",{parentName:"ol"},'Build / Run the site with the usual command: "npm run dev"'),(0,o.kt)("li",{parentName:"ol"},"Browse the site")),(0,o.kt)("h3",{id:"file-structure"},"File Structure"),(0,o.kt)("p",null,'The project currently contains the following "components" / "pages" structure:'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"components/Layout.js:"),' The main / shared layout for the site. This contains the navbar as well as the headline "Online Shopping".')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"components/ProductBox.js:"),' This is the component responsible for rendering a specific product on the "/products" page. It takes a product as a property and renders the details (image, description, price, etc.) in a ',"<","div",">","...","<","/div",">",' element with a maximum width of "300px". Additionally, it contains buttons that either link to the specific product details page ("/products/',"[id]",'"), or invoke an "addToCart()" function with the current product object. Currently, "addToCart()" simply outputs the product to the console with the message: "TODO: Add to Cart".')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"pages/Products/","[id]",".js:"),' This page renders additional details for a specific product (brand, rating, stock, etc.), based on the "id" parameter. Like "ProductBox", it contains an "addToCart" function that has not yet been implemented as well as a button that links back to the product list ("/products"). Additionally, it makes use of ',(0,o.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/basic-features/data-fetching/get-static-paths"},'"getStaticPaths()"')," and ",(0,o.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/basic-features/data-fetching/get-static-props"},'"getStaticProps()"')," in order to pre-render the 30 potential products available.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"pages/Products/index.js:"),' This is the page that renders a single "ProductBox" for all 30 available products in a grid using ',(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Flexbox"},"Flexbox"),'. Like the "Products/',"[id]",'" page, it makes use of ',(0,o.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/basic-features/data-fetching/get-static-props"},'"getStaticProps()"')," in order to pre-render the 30 products to be displayed.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"pages/","_","app.js:")," Contains the boilerplate code for a Next.js app, with the addition of the ","<","Layout",">","...","<","/Layout",">"," component.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"pages/cart.js:"),' Currently only shows the text "Cart" - this is where we will eventually render the products currently contained within the "cart"')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"pages/index.js:"),' Simply renders the "Home" component on the default route "/" - currently contains a short description of the demo.'))),(0,o.kt)("h2",{id:"adding-cart-state-with-jotai"},'Adding "Cart" state with Jotai'),(0,o.kt)("p",null,"Before we begin, we must install Jotai using the command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"npm i jotai\n")),(0,o.kt)("p",null,'Next, if would like to make our "cart" (ie: a list of "products" that the user wishes to purchase) available anywhere within the site, we should create an "atom" to store the values. Additionally, let\'s also include Product 1 (iPhone 9) and Product 2 (iPhone X) as default values for the cart:'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"File:"),' "/my-app/store.js"'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { atom } from 'jotai';\n\nasync function defaultValues() {\n  const results = [];\n\n  // Fetch Product 1\n\n  const prod1Result = await fetch('https://dummyjson.com/products/1');\n  const prod1 = await prod1Result.json();\n\n  results.push(prod1);\n\n  // Fetch Product 2\n\n  const prod2Result = await fetch('https://dummyjson.com/products/2');\n  const prod2 = await prod2Result.json();\n\n  results.push(prod2);\n\n  return results;\n}\n\nexport const cartListAtom = atom(defaultValues());\n")),(0,o.kt)("p",null,'As before, we have created a "store.js" file, imported the "atom" function from \'jotai\' and defined and exported an atom ("cartListAtom"). The default value for the atom is an array of products, obtained by invoking the asynchronous "defaultValues()" function.'),(0,o.kt)("h3",{id:"updating-layout"},'Updating "Layout"'),(0,o.kt)("p",null,'The first component that we would like to update to use the newly created "cartListAtom" is "Layout". Here, we will show how many products have been added to the cart in parentheses next to the "Shopping Cart" link:'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"File:"),' "/components/Layout.js"'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'import Link from \'next/link\';\nimport { useAtom } from \'jotai\';\nimport { cartListAtom } from \'@/store\';\n\nexport default function Layout(props) {\n\n  const [cartList, setCartList] = useAtom(cartListAtom);\n\n  return (\n    <>\n      <div style={{ padding: "10px" }}>\n        <h2>Online Shopping</h2>\n        <Link href="/">Home</Link> | <Link href="/products">Products</Link> | <Link href="/cart">Shopping Cart <span>({cartList.length})</span></Link>\n        <hr />\n        {props.children}\n      </div>\n    </>\n  )\n}\n')),(0,o.kt)("p",null,'Notice how we updated the component to use both "useAtom" from \'jotai\' and "cartListAtom" from \'@/store\' (our store.js file containing the atom definition). In the component, we use "useAtom" in the same way that we use "useState" only the "default value" is the atom "cartListAtom". This gives us full read/write access to the atom, shared by the rest of the site.'),(0,o.kt)("p",null,'If we refresh the site after making this change, we should see that the "Shopping Cart" link has been updated to read "Shopping Cart (2)".'),(0,o.kt)("h3",{id:"updating-addtocart-functions"},'Updating "addToCart()" Functions'),(0,o.kt)("p",null,'The next piece that we should update is the "addToCart()" functions that exist in both "/pages/products/',"[id]",'.js" and "/components/ProductBox.js" files.'),(0,o.kt)("p",null,'In both cases, we must add the cartListAtom from the correct "store" location, as well as the useAtom function:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { useAtom } from 'jotai';\n// import { cartListAtom } from '@/store'; // used in /components/ProductBox.js\n// import { cartListAtom } from '@/store'; // used in /pages/products/[id].js\n")),(0,o.kt)("p",null,"One we have the atom, we must reference it in the component using the syntax:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const [cartList, setCartList] = useAtom(cartListAtom);\n")),(0,o.kt)("p",null,'Finally, we can update the "addToCart()" function to add the product to the cart:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function addToCart(product) {\n  setCartList([...cartList, product]);\n}\n")),(0,o.kt)("p",null,"Since we are modifying the current list of items, we must use ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax"},'"spread syntax"')," to include all of the previous products in the list, in addition to the product to specify the state."),(0,o.kt)("p",null,'If we refresh the site now, we should be able to click any "Add to Cart" button, and see the "Shopping Cart" number increase in the navigation bar.'),(0,o.kt)("h3",{id:"updating-the-cart-page"},'Updating the "cart" Page'),(0,o.kt)("p",null,'The final piece of functionality that we must add is to show all of the products currently within the cart on the "cart" page, as well as a total cost for all of the products within the cart.'),(0,o.kt)("p",null,'Once again, to gain access to the products in the cart, we must add the cartListAtom from the "store" as well as the useAtom function:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { useAtom } from 'jotai';\nimport { cartListAtom } from '@/store';\n")),(0,o.kt)("p",null,"Followed by the code to reference it in the component:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const [cartList, setCartList] = useAtom(cartListAtom);\n")),(0,o.kt)("p",null,"With this in place, the following JSX code can be added to render the products in a list:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"return (\n  <>\n    <br />\n    <ul>\n      {cartList.map((product, index) =>(\n        <li key={index}>\n          <strong>{product.title}</strong>: {product.description}<br />\n          <strong>${product.price.toFixed(2)}</strong>\n          <br /><br />\n        </li>\n      ))}\n    </ul>\n    <hr />\n    <ul>\n      <li>\n        <strong>Total: ${cartList.reduce((total, prod) => total + prod.price, 0).toFixed(2)}</strong>\n      </li>\n    </ul>\n  </>\n)\n")),(0,o.kt)("p",null,'With this complete, we can now browse the site and add products to the cart. To view all of the items in the cart the "cart" page should now show an updated list with a total cost.'))}u.isMDXComponent=!0},8209:(t,e,n)=>{n(7294)}}]);