"use strict";(self.webpackChunkipc144=self.webpackChunkipc144||[]).push([[2660],{3905:(e,t,o)=>{o.d(t,{Zo:()=>u,kt:()=>h});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=n.createContext({}),p=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(o),d=a,h=c["".concat(s,".").concat(d)]||c[d]||m[d]||r;return o?n.createElement(h,i(i({ref:t},u),{},{components:o})):n.createElement(h,i({ref:t},u))}));function h(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:a,i[1]=l;for(var p=2;p<r;p++)i[p]=o[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}d.displayName="MDXCreateElement"},8100:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var n=o(7462),a=(o(7294),o(3905));o(8209);const r={id:"continuous-deployment",title:"Continuous Deployment",sidebar_position:2,description:"Continuous Deployment"},i="Continuous Deployment",l={unversionedId:"Deployment-Automated-Testing/continuous-deployment",id:"Deployment-Automated-Testing/continuous-deployment",title:"Continuous Deployment",description:"Continuous Deployment",source:"@site/docs/Deployment-Automated-Testing/continuous-deployment.md",sourceDirName:"Deployment-Automated-Testing",slug:"/Deployment-Automated-Testing/continuous-deployment",permalink:"/Deployment-Automated-Testing/continuous-deployment",draft:!1,editUrl:"hhttps://github.com/patrick-crawford/WebProgrammingForAppsAndServices/tree/master/docs/Deployment-Automated-Testing/continuous-deployment.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"continuous-deployment",title:"Continuous Deployment",sidebar_position:2,description:"Continuous Deployment"},sidebar:"courseNotesSidebar",previous:{title:"Continuous Integration",permalink:"/Deployment-Automated-Testing/continuous-integration"},next:{title:"Example Code",permalink:"/Deployment-Automated-Testing/example-code"}},s={},p=[{value:"Introduction to Vercel",id:"introduction-to-vercel",level:3},{value:"Updating the Production Site",id:"updating-the-production-site",level:3},{value:"Preview Deployments",id:"preview-deployments",level:4}],u={toc:p},c="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(c,(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"continuous-deployment"},"Continuous Deployment"),(0,a.kt)("p",null,'The second piece of the "CI/CD" acronym may either stand for "Continuous Delivery" or "Continuous Deployment". From ',(0,a.kt)("a",{parentName:"p",href:"https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment"},"Atlassian"),":"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Continuous Delivery"),":"),(0,a.kt)("p",{parentName:"blockquote"},"Continuous delivery is an extension of continuous integration since it automatically deploys all code changes to a testing and/or production environment after the build stage."),(0,a.kt)("p",{parentName:"blockquote"},"This means that on top of automated testing, you have an automated release process and you can deploy your application any time by clicking a button."),(0,a.kt)("p",{parentName:"blockquote"},"In theory, with continuous delivery, you can decide to release daily, weekly, fortnightly, or whatever suits your business requirements. However, if you truly want to get the benefits of continuous delivery, you should deploy to production as early as possible to make sure that you release small batches that are easy to troubleshoot in case of a problem."),(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Continuous Deployment"),":"),(0,a.kt)("p",{parentName:"blockquote"},"Continuous deployment goes one step further than continuous delivery. With this practice, every change that passes all stages of your production pipeline is released to your customers. There's no human intervention, and only a failed test will prevent a new change to be deployed to production."),(0,a.kt)("p",{parentName:"blockquote"},"Continuous deployment is an excellent way to accelerate the feedback loop with your customers and take pressure off the team as there isn't a \"release day\" anymore. Developers can focus on building software, and they see their work go live minutes after they've finished working on it.")),(0,a.kt)("p",null,'For our purposes, we will be discussing and practicing "Continuous Deployment" using the same "app-with-tests" ',(0,a.kt)("a",{parentName:"p",href:"/Deployment-Automated-Testing/example-code"},"example code"),' from the discussion on "Continuous Integration" (if you wish to begin with a completed version of that code, you may use the "app-with-CI" folder. However, you will need your code to be pushed to GitHub for the following instructions).'),(0,a.kt)("h3",{id:"introduction-to-vercel"},"Introduction to Vercel"),(0,a.kt)("p",null,"To add Continuous Deployment to our pipeline, we will leverage the excellent free services available from ",(0,a.kt)("a",{parentName:"p",href:"https://vercel.com/"},"Vercel"),", the creators of Next.js."),(0,a.kt)("p",null,"To begin using Vercel, we must ensure that our code has been pushed to a public Git provider such as: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com"},"GitHub"),", ",(0,a.kt)("a",{parentName:"p",href:"https://gitlab.com"},"GitLab")," or ",(0,a.kt)("a",{parentName:"p",href:"https://bitbucket.org/"},"BitBucket"),". If you have been following along with the ",(0,a.kt)("a",{parentName:"p",href:"/Deployment-Automated-Testing/continuous-integration"},"Continuous Integration")," instructions, this should indeed be the case."),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"First, browse to ",(0,a.kt)("a",{parentName:"p",href:"https://vercel.com"},"https://vercel.com"),' and hit the "Start Deploying" button.')),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Next, press the "Continue with GitHub" button, since our code is located on GitHub.')),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"If you are not currently logged in to GitHub, you will need to provide your credentials in a pop-up window before continuing.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Once you have logged in to GitHub, you will be taken to the ",(0,a.kt)("strong",{parentName:"p"},"Let's build something new."),' screen in Vercel, which prompts you to "Import Git Repository". From here, you will need to click "+ Add GitHub Account"'))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Add Github Account",src:o(8544).Z,width:"630",height:"207"})),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},'This will prompt you to "Install Vercel". From here, we would like to find our specific app, ie "my-app" on GitHub. You will need to start by clicking your account and choosing the ',(0,a.kt)("strong",{parentName:"li"},'"Only select repositories"'),' and finding the "my-app" repository.')),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Select Repositories",src:o(4625).Z,width:"483",height:"315"})),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Once you have selected the target repository (ie: "my-app"), click the green ',(0,a.kt)("strong",{parentName:"p"},"Install")," button")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"You should now see the ",(0,a.kt)("strong",{parentName:"p"},"my-app")," repository available for import. To proceed, click ",(0,a.kt)("strong",{parentName:"p"},"Import")))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Import my-app Repository",src:o(30).Z,width:"632",height:"235"})),(0,a.kt)("ol",{start:8},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'At the next page, you are not required to make any changes, as Vercel should detect that we are using Next.js in the "framework preset". If you had any ',(0,a.kt)("em",{parentName:"p"},"environment variables"),", you could set them here. However, since we aren't currently using any environment variables, click ",(0,a.kt)("strong",{parentName:"p"},"Deploy"),".")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},'Once the deploy step has completed, you should be taken to a "Congratulations!" page with a black button labeled ',(0,a.kt)("strong",{parentName:"p"},"Go To Dashboard"),". Click this to see the information about your deployment."))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Vercel Dashboard for my-app",src:o(6117).Z,width:"1686",height:"1166"})),(0,a.kt)("ol",{start:10},(0,a.kt)("li",{parentName:"ol"},'From the dashboard, we are presented with some important information, primarily the "Domains" section, which shows the production URL of the app (in this case: my-app-lime-eight.vercel.app)')),(0,a.kt)("h3",{id:"updating-the-production-site"},"Updating the Production Site"),(0,a.kt)("p",null,'Now that we have a working site deployed on Vercel (ie: in "Production"), let\'s take a step back and see how we can use this pipeline to make an update:'),(0,a.kt)("p",null,'For example, say we wish to append the text "(Starter Site)" to the ',"<","title",">","...","<","title",">",' element of the "Home" page:'),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Create (and switch to) a new branch for this update.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"git checkout -b fix/home-title\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Update the code and save your changes, ie:"),(0,a.kt)("p",{parentName:"li"},(0,a.kt)("strong",{parentName:"p"},"File:"),' "pages/index.js"'))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<title>Create Next App (Starter Site)</title>\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Commit your local changes:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},'git add .\ngit commit -m "appended text to title on Home"\n')),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},'Push the "fix/home-title" branch to GitHub')),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"git push origin fix/home-title\n")),(0,a.kt)("h4",{id:"preview-deployments"},"Preview Deployments"),(0,a.kt)("p",null,'If you navigate back to the dashboard for the Vercel app, you will see that we now have a "Preview Deployment", generated from our push to the "fix/home-title" branch:'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Preview Deployment",src:o(1184).Z,width:"2458",height:"390"})),(0,a.kt)("p",null,'Effectively, this means that we have not altered our production site (my-app-lime-eight.vercel.app), but instead created a "Preview" of what the production site would look like with the change. In this case, this preview has been assigned the url "my-jk1f8wunw-patrick-crawford.vercel.app".'),(0,a.kt)("p",null,"As before, since we pushed a separate branch to our repository, GitHub gives an option to create a Pull Request. Once we do, we can confirm that Vercel has created the preview deployment and all of our tests passed:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Preview Deployment",src:o(9045).Z,width:"1826",height:"1344"})),(0,a.kt)("p",null,'If the "Preview" is approved, then we can proceed to merge the pull request. This will trigger a rebuild with Vercel and our production site will be updated to match the Preview.'),(0,a.kt)("p",null,'As before, if you wish to update your local "master" branch with the fix, you can issue the commands:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-console"},"git checkout master\ngit pull origin master\n")))}m.isMDXComponent=!0},8544:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/vercel-1-2cf83c1624180605aa3fe898bccf496c.png"},4625:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/vercel-2-dbb2558aa9e1e9b5e59be0936c86ad2f.png"},30:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/vercel-3-54a105bb69839fffba3dadf81788d104.png"},6117:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/vercel-4-f3d245a0607c5aa4eb13d8796e421aaf.png"},1184:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/vercel-5-18e84668c7aca1d9f5cf056692396f5c.png"},9045:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o.p+"assets/images/vercel-6-e526a037357af75e1fd494364bb14c88.png"},8209:(e,t,o)=>{o(7294)}}]);