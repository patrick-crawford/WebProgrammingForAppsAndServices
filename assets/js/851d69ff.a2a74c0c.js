"use strict";(self.webpackChunkOERTemplate=self.webpackChunkOERTemplate||[]).push([[490],{2811:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Introduction-JWT/json-web-tokens-jwt","title":"JSON Web Tokens (JWT)","description":"JSON Web Tokens (JWT)","source":"@site/docs/Introduction-JWT/json-web-tokens-jwt.md","sourceDirName":"Introduction-JWT","slug":"/Introduction-JWT/json-web-tokens-jwt","permalink":"/WebProgrammingForAppsAndServices/Introduction-JWT/json-web-tokens-jwt","draft":false,"unlisted":false,"editUrl":"https://github.com/catherine-leung/OERTemplate/tree/main/docs/Introduction-JWT/json-web-tokens-jwt.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"json-web-tokens-jwt","title":"JSON Web Tokens (JWT)","sidebar_position":2,"description":"JSON Web Tokens (JWT)"},"sidebar":"courseNotesSidebar","previous":{"title":"Web API With Authentication","permalink":"/WebProgrammingForAppsAndServices/Introduction-JWT/web-api-with-authentication"},"next":{"title":"Example Code","permalink":"/WebProgrammingForAppsAndServices/Introduction-JWT/example-code"}}');var r=s(4848),i=s(8453);const a={id:"json-web-tokens-jwt",title:"JSON Web Tokens (JWT)",sidebar_position:2,description:"JSON Web Tokens (JWT)"},o="JSON Web Tokens (JWT)",l={},d=[{value:"Securing routes with JWT",id:"securing-routes-with-jwt",level:2},{value:"jsonwebtoken",id:"jsonwebtoken",level:3},{value:"passport",id:"passport",level:3},{value:"passport-jwt",id:"passport-jwt",level:3},{value:"Adding the code to server.js",id:"adding-the-code-to-serverjs",level:2},{value:"Step 1: Installation",id:"step-1-installation",level:3},{value:"Step 2: Requiring the Modules",id:"step-2-requiring-the-modules",level:3},{value:"Step 3: Configuring the &quot;Strategy&quot;",id:"step-3-configuring-the-strategy",level:3},{value:"Step 4: Set the Strategy &amp; Add the Middleware",id:"step-4-set-the-strategy--add-the-middleware",level:3},{value:"Step 5: Generating &amp; Sending the JWT",id:"step-5-generating--sending-the-jwt",level:3},{value:"Step 6: Protecting Route(s) using the Passport Middleware",id:"step-6-protecting-routes-using-the-passport-middleware",level:3},{value:"Testing the New Functionality",id:"testing-the-new-functionality",level:2}];function c(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"json-web-tokens-jwt",children:"JSON Web Tokens (JWT)"})}),"\n",(0,r.jsxs)(t.p,{children:["With our new authentication routes tested and working correctly, we can now concentrate on leveraging this logic to actually ",(0,r.jsx)(t.strong,{children:"secure"})," the vehicle data in our simple API."]}),"\n",(0,r.jsx)(t.p,{children:"Currently, the /api/vehicles route is available to anyone, regardless of whether they've been authenticated or not. You can see this by:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:'Executing a POST request to "/api/login" with an incorrect password for "bob"'}),"\n",(0,r.jsx)(t.li,{children:'Following the POST request, make a GET request to "/api/vehicles".'}),"\n",(0,r.jsx)(t.li,{children:'Observe that the "/api/vehicles" endpoint displays the vehicle data.'}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:'The fact that we did not provide correct credentials during the "login" phase, had no effect on whether or not we can access the data on the "/api/vehicles" route.'}),"\n",(0,r.jsxs)(t.p,{children:['So, how can we solve this problem? Essentially, what we need is some kind of secure, tamper-proof "logged in" identifier that we can ',(0,r.jsx)(t.strong,{children:"send"}),' back to the client once they have been authenticated ("logged in"). This identifier could be stored on the client and sent with subsequent requests, serving as both identification and proof that they have been authenticated by the server.']}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"JSON Web Token (JWT) to the rescue"})}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. JWTs can be signed using a secret (with the HMAC algorithm) or a public/private key pair using RSA or ECDSA."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["This is perfect for our purposes. We can generate a JWT on the server (only) once the user has been ",(0,r.jsx)(t.strong,{children:"successfully authenticated"}),' and send it back to the client along with the "login successful" message. It will contain digitally-signed information about the authenticated user such as their "userName", "fullName" & "role" (but ',(0,r.jsx)(t.strong,{children:"never"})," their password). The client can then read this information and ",(0,r.jsx)(t.strong,{children:"send the JWT back to the server"}),' in an "Authorization" header with every subsequent request to be verified on the server. Since it is digitally signed on the server using a "secret", we can verify that the data has not been tampered with and that the JWT did indeed come from our simple API server and we can send the requested data.']}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"When should you use JSON Web Tokens?"})," Here are some scenarios where JSON Web Tokens are useful:"]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Authorization:"})," This is the most common scenario for using JWT. Once the user is logged in, each subsequent request will include the JWT, allowing the user to access routes, services, and resources that are permitted with that token. Single Sign On is a feature that widely uses JWT nowadays, because of its small overhead and its ability to be easily used across different domains."]}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Information Exchange:"})," JSON Web Tokens are a good way of securely transmitting information between parties. Because JWTs can be signed\u2014for example, using public/private key pairs\u2014you can be sure the senders are who they say they are. Additionally, as the signature is calculated using the header and the payload, you can also verify that the content hasn't been tampered with."]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["For more information about JWT, including the signature & structure of the payload, see the excellent documentation at ",(0,r.jsx)(t.a,{href:"https://jwt.io/introduction/",children:"https://jwt.io/introduction/"})]}),"\n",(0,r.jsx)(t.h2,{id:"securing-routes-with-jwt",children:"Securing routes with JWT"}),"\n",(0,r.jsx)(t.p,{children:"We have now identified that we would like to work with JWT to secure our routes. However, how do we go about implementing JWT generation and verification in our server.js? This will involve 3 key modules, obtained from NPM:"}),"\n",(0,r.jsx)(t.h3,{id:"jsonwebtoken",children:"jsonwebtoken"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/jsonwebtoken",children:'"jsonwebtoken" module'})," (available using ",(0,r.jsx)(t.code,{children:"npm install jsonwebtoken --save"})," & added to server.js using: ",(0,r.jsx)(t.code,{children:"const jwt = require('jsonwebtoken');"}),"). In our application, this module is used primarily to ",(0,r.jsx)(t.strong,{children:'"sign"'})," our JSON payload with a 'secret' and generate the token, ie:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"let token = jwt.sign({ userName: 'bob' }, 'secret');\n"})}),"\n",(0,r.jsxs)(t.p,{children:["We can also use a 3rd parameter to specify options such as ",(0,r.jsx)(t.strong,{children:"expiresIn"})," (A numeric value is interpreted as a seconds count):"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"jwt.sign({\n  userName: 'bob'\n}, 'secret', { expiresIn: 60 * 60 });\n"})}),"\n",(0,r.jsxs)(t.p,{children:["For more information on the usage of this function including additional options, methods and errors/codes see ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/jsonwebtoken",children:"the documentaiton for jsonwebtoken on npm"})]}),"\n",(0,r.jsx)(t.h3,{id:"passport",children:"passport"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/passport",children:'"passport" module'})," (available using ",(0,r.jsx)(t.code,{children:"npm install passport --save"})," & added to server.js using ",(0,r.jsx)(t.code,{children:'const passport = require("passport");'}),") is described as the following:"]}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)(t.p,{children:"Passport is Express-compatible authentication middleware for Node.js. Passport's sole purpose is to authenticate requests, which it does through an extensible set of plugins known as strategies. Passport does not mount routes or assume any particular database schema, which maximizes flexibility and allows application-level decisions to be made by the developer. The API is simple: you provide Passport a request to authenticate, and Passport provides hooks for controlling what occurs when authentication succeeds or fails."}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"In our application, we will be using the following methods:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:'"initialize"'}),": This method is invoked when we add the passport middleware using the familiar ",(0,r.jsx)(t.strong,{children:"app.use()"})," method, ie:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"app.use(passport.initialize());\n"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:'"authenticate"'}),': The "authenticate" method is used as a middleware function that can be used for each of our routes that we wish to secure. For example:']}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"app.get(\"/api/vehicles\", passport.authenticate('jwt', { session: false }), (req, res) => {\n    // ...\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:'"use"'}),': The "use" method is where we specify our "strategy" for authenticating our routes. This is done near the top of server.js after the "strategy" is configured, ie:']}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"passport.use(strategy);\n"})}),"\n",(0,r.jsx)(t.admonition,{type:"info",children:(0,r.jsxs)(t.p,{children:["Passport currently supports over 480 different authentication strategies including ",(0,r.jsx)(t.a,{href:"https://www.passportjs.org/packages/passport-facebook/",children:"Facebook"}),", ",(0,r.jsx)(t.a,{href:"https://www.passportjs.org/packages/passport-google-oauth20/",children:"Google"})," and ",(0,r.jsx)(t.a,{href:"https://www.passportjs.org/packages/",children:"many others"})]})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.h3,{id:"passport-jwt",children:"passport-jwt"}),"\n",(0,r.jsxs)(t.p,{children:["Since we will be using JWT, our strategy will be ",(0,r.jsx)(t.a,{href:"https://www.passportjs.org/packages/passport-jwt/",children:'"passport-jwt"'})," (available using ",(0,r.jsx)(t.code,{children:"npm install passport-jwt --save"})," & added to server.js using ",(0,r.jsx)(t.code,{children:'const passportJWT = require("passport-jwt");'}),'). Using "passportJWT", we can specify the "strategy" using a set of ',(0,r.jsx)(t.strong,{children:"options"})," (defined in our server as an object called ",(0,r.jsx)(t.strong,{children:"jwtOptions"}),": ",(0,r.jsx)(t.code,{children:"let jwtOptions = {};"}),'), such as the "secretOrKey", as well as specifying how to read the jwt from the authentication header.']}),"\n",(0,r.jsx)(t.p,{children:'For example, once we have a reference to the "passport-jwt" module (ie: "passwordJWT", from above), we can use the following code to configure our strategy:'}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"// JSON Web Token Setup\nlet ExtractJwt = passportJWT.ExtractJwt;\nlet JwtStrategy = passportJWT.Strategy;\n\n// Configure its options\nlet jwtOptions = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderWithScheme('jwt'),\n  secretOrKey: '&0y7$noP#5rt99&GB%Pz7j2b1vkzaB0RKs%^N^0zOP89NT04mPuaM!&G8cbNZOtH',\n};\n\n// IMPORTANT - this secret should be a long, unguessable string\n// (ideally stored in a \"protected storage\" area on the web server).\n// We suggest that you generate a random 50-character string\n// using the following online tool:\n// https://lastpass.com/generatepassword.php\n\nlet strategy = new JwtStrategy(jwtOptions, function (jwt_payload, next) {\n  console.log('payload received', jwt_payload);\n\n  if (jwt_payload) {\n    // The following will ensure that all routes using\n    // passport.authenticate have a req.user._id, req.user.userName, req.user.fullName & req.user.role values\n    // that matches the request payload data\n    next(null, {\n      _id: jwt_payload._id,\n      userName: jwt_payload.userName,\n      fullName: jwt_payload.fullName,\n      role: jwt_payload.role,\n    });\n  } else {\n    next(null, false);\n  }\n});\n"})}),"\n",(0,r.jsxs)(t.p,{children:["There's a lot going on in the above code, but the key pieces involve first defining the ",(0,r.jsx)(t.strong,{children:"jwtOptions"})," (using the ",(0,r.jsx)(t.strong,{children:"jwtFromRequest"})," and ",(0,r.jsx)(t.strong,{children:"secretOrKey"}),' properties) and then defining the "strategy" as a (JwtStrategy) middleware function using the jwtOptions and providing a callback function. The callback function simply checks that there is indeed a valid jwt_payload and if so, invoke the ',(0,r.jsx)(t.strong,{children:"next()"})," method with the payload data as it's second parameter. If the jwt_payload is invalid, the ",(0,r.jsx)(t.strong,{children:"next()"})," method will be called without the payload data, which will cause our server to return a ",(0,r.jsx)(t.strong,{children:"401 (Unauthorized)"})," error."]}),"\n",(0,r.jsx)(t.h2,{id:"adding-the-code-to-serverjs",children:"Adding the code to server.js"}),"\n",(0,r.jsx)(t.p,{children:"With all of the individual pieces of our JWT solution identified, it's now time to update server.js:"}),"\n",(0,r.jsx)(t.h3,{id:"step-1-installation",children:"Step 1: Installation"}),"\n",(0,r.jsx)(t.p,{children:'As you will recall (from above), our JWT enabled server.js will require 3 modules: "jwt", "passport" & "passport-jwt" to function correctly. Using npm, install them into the project:'}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-text",metastring:'title="Terminal"',children:"npm install jsonwebtoken --save\nnpm install passport --save\nnpm install passport-jwt --save\n"})}),"\n",(0,r.jsx)(t.h3,{id:"step-2-requiring-the-modules",children:"Step 2: Requiring the Modules"}),"\n",(0,r.jsx)(t.p,{children:"After installation, add the modules to our list of imports at the top of server js:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",metastring:'title="server.js"',children:"const jwt = require('jsonwebtoken');\nconst passport = require('passport');\nconst passportJWT = require('passport-jwt');\n"})}),"\n",(0,r.jsx)(t.h3,{id:"step-3-configuring-the-strategy",children:'Step 3: Configuring the "Strategy"'}),"\n",(0,r.jsxs)(t.p,{children:['With our modules added, we can now add the code to configure the JWT "strategy". Recall, this involves creating a ',(0,r.jsx)(t.strong,{children:"jwtOptions"})," object that we can pass to the ",(0,r.jsx)(t.strong,{children:"jwtStrategy"}),' constructor, along with a callback function that looks at the "jwt_payload" parameter. For our purposes, we can use the code exactly as it has been identified above, placed before our first "app.use()" statement. However, a ',(0,r.jsx)(t.strong,{children:"new"}),' "secretOrKey" property should be generated (optionally using the ',(0,r.jsx)(t.a,{href:"https://www.lastpass.com/password-generator",children:'"Generate Password" Tool'})," from LastPass)."]}),"\n",(0,r.jsx)(t.admonition,{type:"caution",children:(0,r.jsxs)(t.p,{children:['If the "user" has different properties (ie, something ',(0,r.jsx)(t.em,{children:"other"}),' than, "_id", "userName", "fullName" and "role"), the data passed in the ',(0,r.jsx)(t.strong,{children:"next()"})," function should be modified to reflect the correct properties."]})}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"How to add the strategy"}),":"]}),"\n",(0,r.jsxs)(t.p,{children:["In server.js, add this code ",(0,r.jsx)(t.strong,{children:"before"})," the first usage of ",(0,r.jsx)(t.code,{children:"app.use()"}),":"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",metastring:'title="server.js, before the first app.use() statement"',children:"// JSON Web Token Setup\nlet ExtractJwt = passportJWT.ExtractJwt;\nlet JwtStrategy = passportJWT.Strategy;\n\n// Configure its options\nlet jwtOptions = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderWithScheme('jwt'),\n  secretOrKey: '&0y7$noP#5rt99&GB%Pz7j2b1vkzaB0RKs%^N^0zOP89NT04mPuaM!&G8cbNZOtH',\n};\n\n// IMPORTANT - this secret should be a long, unguessable string\n// (ideally stored in a \"protected storage\" area on the web server).\n// We suggest that you generate a random 50-character string\n// using the following online tool:\n// https://lastpass.com/generatepassword.php\n\nlet strategy = new JwtStrategy(jwtOptions, function (jwt_payload, next) {\n  console.log('payload received', jwt_payload);\n\n  if (jwt_payload) {\n    // The following will ensure that all routes using\n    // passport.authenticate have a req.user._id, req.user.userName, req.user.fullName & req.user.role values\n    // that matches the request payload data\n    next(null, {\n      _id: jwt_payload._id,\n      userName: jwt_payload.userName,\n      fullName: jwt_payload.fullName,\n      role: jwt_payload.role,\n    });\n  } else {\n    next(null, false);\n  }\n});\n"})}),"\n",(0,r.jsx)(t.h3,{id:"step-4-set-the-strategy--add-the-middleware",children:"Step 4: Set the Strategy & Add the Middleware"}),"\n",(0,r.jsxs)(t.p,{children:['The last step needed to tell our server that we wish to use Passport (with the "JWT" strategy), by adding the function as middleware to our server using ',(0,r.jsx)(t.strong,{children:"app.use()"}),":"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",metastring:'title="server.js"',children:'// tell passport to use our "strategy"\npassport.use(strategy);\n\n// add passport as application-level middleware\napp.use(passport.initialize());\n'})}),"\n",(0,r.jsx)(t.h3,{id:"step-5-generating--sending-the-jwt",children:"Step 5: Generating & Sending the JWT"}),"\n",(0,r.jsxs)(t.p,{children:["At this point, we're all set to work with JWT. We have the correct modules added and the Passsport middleware is configured and added to our application. However, before we can ",(0,r.jsx)(t.em,{children:"protect"})," our routes (see below), we need to first ",(0,r.jsx)(t.strong,{children:"send"})," the token back to the client. Currently, our api/login route simply sends the following data with a 200 status code to indicate that the login was indeed successful:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{ "message": "login successful" }\n'})}),"\n",(0,r.jsxs)(t.p,{children:["If we wish to grant this user access to our (soon to be) protected routes, we must also provide the JWT as a means of identification. Using the ",(0,r.jsx)(t.strong,{children:"sign()"})," method of the included ",(0,r.jsx)(t.strong,{children:"jsonwebtoken"}),' module, we can generate it and send it back to the client alongside the "message".']}),"\n",(0,r.jsxs)(t.p,{children:['To accomplish this, we need to add the following code to our "/api/login" route at the top of our ',(0,r.jsx)(t.strong,{children:"userService.checkUser(req.body).then( ... )"})," callback:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",metastring:'title="server.js"',children:"let payload = {\n  _id: user._id,\n  userName: user.userName,\n  fullName: user.fullName,\n  role: user.role,\n};\n\nlet token = jwt.sign(payload, jwtOptions.secretOrKey);\n"})}),"\n",(0,r.jsx)(t.p,{children:'This will generate a JWT for us using the user\'s "_id", "userName", "fullName" and "role" properties, encrypted with our "secretOrKey" (identified when we configured our passport strategy in jwtOptions).'}),"\n",(0,r.jsxs)(t.p,{children:["Once we have the token, we can send it back along with the message to the user using ",(0,r.jsx)(t.strong,{children:"res.json()"}),' (typically using the property: "token"):']}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",metastring:'title="server.js"',children:"res.json({ message: 'login successful', token: token });\n"})}),"\n",(0,r.jsx)(t.h3,{id:"step-6-protecting-routes-using-the-passport-middleware",children:"Step 6: Protecting Route(s) using the Passport Middleware"}),"\n",(0,r.jsxs)(t.p,{children:['In order to restrict access to our /api/vehicles route, we need to employ the Passport middleware "authenticate" function (identified above in our ',(0,r.jsx)(t.strong,{children:"authenticate()"})," example)."]}),"\n",(0,r.jsx)(t.p,{children:"This simply involves adding the code:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",children:"passport.authenticate('jwt', { session: false })\n"})}),"\n",(0,r.jsx)(t.p,{children:"as a middleware function to any routes that we wish to protecet (ie: our /api/vehicles route):"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-javascript",metastring:'title="server.js"',children:"app.get(\"/api/vehicles\", passport.authenticate('jwt', { session: false }), (req, res) => {\n    // ...\n}\n"})}),"\n",(0,r.jsxs)(t.p,{children:['You will notice that we provide the option "session: false". This is because we require credentials to be supplied with each request, rather than set up a session. For more information and configuration options, see the Passport.js documentation, under ',(0,r.jsx)(t.a,{href:"http://www.passportjs.org/docs/authenticate/",children:'"Authenticate"'}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"testing-the-new-functionality",children:"Testing the New Functionality"}),"\n",(0,r.jsx)(t.p,{children:"We have now completed all of the changes that are required on our server.js and are ready to test our Simple API and see if this technology really works to protect our routes."}),"\n",(0,r.jsx)(t.p,{children:"To test this, we must insure the following series of actions yields the expected results (listed below):"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Action"}),": Attempt to access the route /api/vehicles as before (without supplying a JWT)."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Expected Result:"}),' Server returns a 401 error code and the text "unauthorized".']}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Unauthorized",src:s(4802).A+"",width:"2070",height:"1556"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Action"}),': Log in as user "bob" (as above) and copy the value of the returned "token" property.']}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Login Token",src:s(2985).A+"",width:"2074",height:"1566"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Action"}),': Attempt to access the route /api/vehicles as before, only this time add the header "Authorization" with the value "JWT" followed by a ',(0,r.jsx)(t.em,{children:"space"}),', followed by the returned "token" that was sent when "bob" logged in (above)']}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Expected Result:"})," Vehicle data is returned"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Vehicle Data",src:s(8784).A+"",width:"2070",height:"1562"})}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Action"}),": Attempt to access the route /api/vehicles again, only this time slightly modify the JWT (ie: remove/add a character)."]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.strong,{children:"Expected Result"}),': Server returns a 401 error code and the text "unauthorized".']}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Unauthorized",src:s(6815).A+"",width:"2064",height:"1562"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},2985:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/API-test-2-471ecc31eed22ec3571dc3636a60bcdc.png"},4802:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/API-test-1-9a6b71f05a4b4f2bcdcf3785673e0e98.png"},6815:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/API-test-4-5b00d77744c9ea8b91ca7fa9df8af8b0.png"},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(6540);const r={},i=n.createContext(r);function a(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(i.Provider,{value:t},e.children)}},8784:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/API-test-3-7fab454fdd2d0e8dd8183146a84b7114.png"}}]);